<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>函数的参数 | Node.js API 文档</title>
  <link rel="icon" sizes="32x32" type="image/png" href="//static.nodejs.cn/_static/img/favicon.png">
  <script>
    document.write('<link href="http://nodejs.cn/api/addons/' + (location.port?'':'//static.nodejs.cn') + '/_static/css/api.css?1544712009848" rel="stylesheet">')
  </script>
<link rel="icon" sizes="32x32" type="image/png" href="//static.nodejs.cn/_static/img/favicon.png">    <link href="index.css" rel="stylesheet">    <style>        html #hm_t_undefined .hm-t-go-top {position:fixed;right:2px;bottom:2px;z-index:99998;cursor:pointer;width:40px;height:37px!important;text-align:center;white-space:normal;font-size:14px;line-height:17px;padding-top:3px;color:#fff;background:#404040;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAAAXCAYAAABH92JbAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMjgwMTE3NDA3MjA2ODExODA4M0UyNDA4ODdDRTZBQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQjc5RkRFNkI5ODMxMUUzQkZGNDhENEJFQjM2OTcyRiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQjc5RkRFNUI5ODMxMUUzQkZGNDhENEJFQjM2OTcyRiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDI4MDExNzQwNzIwNjgxMTgwODNFMjQwODg3Q0U2QUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDI4MDExNzQwNzIwNjgxMTgwODNFMjQwODg3Q0U2QUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5HPYM5AAACC0lEQVR42uyZTSgEYRjH90NoqaVcpDblvKW2XOSkNh8H5Yac9sBBDqQokiJKSMpNTi5OPo6Ktsgu67JcUHIXWfK1u3b8Xx6Zxuzu+64dM83uv34zNfu8b8/8Z+d5P8YqSZLFJNLsRmyWvIRMKgVD4AhEwA3YAV0pzGwEqyAEwmAddIICHe7FqhnsdQM14FxKLj+ooFiGE2ykiD8GVbJ4I1ELAnTmasMODnAhpVcIFIMicMgRH6Z4IxnUAh4pP3Zu5TVpUOLXDJgWiB8wkEF9IK7IL07X05oUFLjpZ4JXQQOYYwfzafJcoDjVPqw43KE4lWtUTF+AQ8eBqQSsgTaO2E0apJ7URrdCDZOM62hQJfBzGmShOD+1+2XSiYaJ7utkkBsEgEewnYfauZUmzWmU6DuY0sEgLzgArgzbu6i992cu/1WclqXsa1iHIt0DYlnKP0b9fRZu5pWdZs7dWXqa7B80+s//oF5aMSjflGqBPq5BQnFtVv4UmGHjIPEH96PAZ6C5kVMwf6daPzbFKnqCqvx9Bk/yFjSBFTMvcL+1DerAmUA/p9Rm1+y7AHJdgnqwx9EHm1s0gKtc2CpR6gE00/ZHMm3RKxbJlf0kNb2BDrCk8hsbDdvBay5tuiUTGxL7waTs2iLw0YTR9BLZQRwDUVqwjuTS9q3VRB8C1OQUnM6UqdXX/IcADn0IMADs2AqDOPSutQAAAABJRU5ErkJggg==) no-repeat -42px center #666;*background-image:url(http://ecma.bdimg.com/holmes/t-popup-icons-png8.png);_position:absolute;_top:expression(eval(document.documentElement.scrollTop+(document.documentElement.clientHeight||document.body.clientHeight)-this.offsetHeight-2));}    </style></head>
<body class="alt apidoc" id="page_api_item">
  <div id="api-section-addons">
    <div id="content" class="clearfix">
  
      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>函数的参数</h1>
          <div id="gtoc">
            <ul>
              <li>
                <a href="addons.html#addons_function_arguments" tppabs="http://nodejs.cn/api/addons.html#addons_function_arguments" name="toc">返回上层文档</a>
              </li>
              <li>
                <a href="javascript:if(confirm('http://nodejs.cn/search  \n\n���ļ��޷��� Teleport Ultra ����, ��Ϊ ����һ�����·���ⲿ������Ϊ������ʼ��ַ�ĵ�ַ��  \n\n�����ڷ������ϴ���?'))window.location='http://nodejs.cn/search'" tppabs="http://nodejs.cn/search" name="toc">搜索</a>
              </li>
            </ul>
          </div>
          <hr>
        </header>
  
        <div id="apicontent">
          <div id="content_left"><p>&#x63D2;&#x4EF6;&#x901A;&#x5E38;&#x4F1A;&#x5F00;&#x653E;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;&#x548C;&#x51FD;&#x6570;&#xFF0C;&#x4F9B;&#x8FD0;&#x884C;&#x5728; Node.js &#x4E2D;&#x7684; JavaScript &#x8BBF;&#x95EE;&#x3002;
&#x5F53;&#x4ECE; JavaScript &#x8C03;&#x7528;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x8F93;&#x5165;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C;&#x5FC5;&#x987B;&#x4E0E; C/C++ &#x4EE3;&#x7801;&#x76F8;&#x4E92;&#x6620;&#x5C04;&#x3002;</p><p>&#x4EE5;&#x4E0B;&#x4F8B;&#x5B50;&#x63CF;&#x8FF0;&#x4E86;&#x5982;&#x4F55;&#x8BFB;&#x53D6;&#x4ECE; JavaScript &#x4F20;&#x5165;&#x7684;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x4E0E;&#x5982;&#x4F55;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#xFF1A;</p><pre><code class="language-cpp">// addon.cc
#include &lt;node.h&gt;

namespace demo {

using v8::Exception;
using v8::FunctionCallbackInfo;
using v8::Isolate;
using v8::Local;
using v8::Number;
using v8::Object;
using v8::String;
using v8::Value;

// &#x8FD9;&#x662F; &quot;add&quot; &#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;
// &#x8F93;&#x5165;&#x53C2;&#x6570;&#x4F7F;&#x7528; const FunctionCallbackInfo&lt;Value&gt;&amp; args &#x7ED3;&#x6784;&#x4F20;&#x5165;
void Add(const FunctionCallbackInfo&lt;Value&gt;&amp; args) {
  Isolate* isolate = args.GetIsolate();

  // &#x68C0;&#x67E5;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x7684;&#x4E2A;&#x6570;
  if (args.Length() &lt; 2) {
    // &#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x5E76;&#x4F20;&#x56DE;&#x5230; JavaScript
    isolate-&gt;ThrowException(Exception::TypeError(
        String::NewFromUtf8(isolate, &quot;&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;&#x9519;&#x8BEF;&quot;)));
    return;
  }

  // &#x68C0;&#x67E5;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;
  if (!args[0]-&gt;IsNumber() || !args[1]-&gt;IsNumber()) {
    isolate-&gt;ThrowException(Exception::TypeError(
        String::NewFromUtf8(isolate, &quot;&#x53C2;&#x6570;&#x9519;&#x8BEF;&quot;)));
    return;
  }

  // &#x6267;&#x884C;&#x64CD;&#x4F5C;
  double value = args[0]-&gt;NumberValue() + args[1]-&gt;NumberValue();
  Local&lt;Number&gt; num = Number::New(isolate, value);

  // &#x8BBE;&#x7F6E;&#x8FD4;&#x56DE;&#x503C;
  args.GetReturnValue().Set(num);
}

void Init(Local&lt;Object&gt; exports) {
  NODE_SET_METHOD(exports, &quot;add&quot;, Add);
}

NODE_MODULE(NODE_GYP_MODULE_NAME, Init)

}  // namespace demo
</code></pre><p>&#x4F46;&#x5DF2;&#x88AB;&#x7F16;&#x8BD1;&#xFF0C;&#x793A;&#x4F8B;&#x63D2;&#x4EF6;&#x5C31;&#x53EF;&#x4EE5;&#x5728; Node.js &#x4E2D;&#x5F15;&#x5165;&#x548C;&#x4F7F;&#x7528;&#xFF1A;</p><pre><code class="language-js">// test.js
const addon = require(&apos;./build/Release/addon&apos;);

console.log(&apos;This should be eight:&apos;, addon.add(3, 5));
</code></pre></div>
          <div id="content_right"><p>Addons will typically expose objects and functions that can be accessed from
JavaScript running within Node.js. When functions are invoked from JavaScript,
the input arguments and return value must be mapped to and from the C/C++
code.</p><p>The following example illustrates how to read function arguments passed from
JavaScript and how to return a result:</p><pre><code class="language-cpp">// addon.cc
#include &lt;node.h&gt;

namespace demo {

using v8::Exception;
using v8::FunctionCallbackInfo;
using v8::Isolate;
using v8::Local;
using v8::Number;
using v8::Object;
using v8::String;
using v8::Value;

// This is the implementation of the &quot;add&quot; method
// Input arguments are passed using the
// const FunctionCallbackInfo&lt;Value&gt;&amp; args struct
void Add(const FunctionCallbackInfo&lt;Value&gt;&amp; args) {
  Isolate* isolate = args.GetIsolate();

  // Check the number of arguments passed.
  if (args.Length() &lt; 2) {
    // Throw an Error that is passed back to JavaScript
    isolate-&gt;ThrowException(Exception::TypeError(
        String::NewFromUtf8(isolate, &quot;Wrong number of arguments&quot;)));
    return;
  }

  // Check the argument types
  if (!args[0]-&gt;IsNumber() || !args[1]-&gt;IsNumber()) {
    isolate-&gt;ThrowException(Exception::TypeError(
        String::NewFromUtf8(isolate, &quot;Wrong arguments&quot;)));
    return;
  }

  // Perform the operation
  double value =
      args[0].As&lt;Number&gt;()-&gt;Value() + args[1].As&lt;Number&gt;()-&gt;Value();
  Local&lt;Number&gt; num = Number::New(isolate, value);

  // Set the return value (using the passed in
  // FunctionCallbackInfo&lt;Value&gt;&amp;)
  args.GetReturnValue().Set(num);
}

void Init(Local&lt;Object&gt; exports) {
  NODE_SET_METHOD(exports, &quot;add&quot;, Add);
}

NODE_MODULE(NODE_GYP_MODULE_NAME, Init)

}  // namespace demo
</code></pre><p>Once compiled, the example Addon can be required and used from within Node.js:</p><pre><code class="language-js">// test.js
const addon = require(&apos;./build/Release/addon&apos;);

console.log(&apos;This should be eight:&apos;, addon.add(3, 5));
</code></pre></div>
          <div></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.write('<script src="' + (location.port ? '' : 'http://static.nodejs.cn/') + '/_static/js/api.js?1544712009848"><\/script>');
  </script>
</body>
</html>